.\" This manpage has been automatically generated by docbook2man 
.\" from a DocBook document.  This tool can be found at:
.\" <http://shell.ipoline.com/~elmert/comp/docbook2X/> 
.\" Please send any bug reports, improvements, comments, patches, 
.\" etc. to Steve Cheng <steve@ggi-project.org>.
.TH "GNT-NODE" "8" "13 June 2008" "ganeti 1.2" ""

.SH NAME
gnt-node \- node administration
.SH SYNOPSIS

\fBgnt-node \fR \fBcommand\fR [ \fBarguments...\fR ]

.SH "DESCRIPTION"
.PP
The \fBgnt-node\fR is used for managing the
(physical) nodes in the ganeti system.
.SH "COMMANDS"
.SS "ADD"

\fBadd\fR [ \fB--readd\fR ] [ \fB-s \fIsecondary_ip\fB\fR ] \fB\fInodename\fB\fR

.PP
Adds the given node to the cluster.
.PP
This command is used to join a new node to the cluster. You
will have to provide the password for root of the node to be
able to add the node in the cluster. The command needs to be
run on the ganeti master.
.PP
Note that the command is potentially destructive, as it will
forcibly join the specified host the cluster, not paying
attention to its current status (it could be already in a
cluster, etc.)
.PP
The \fB-s\fR is used in dual-home clusters and
specifies the new node's IP in the secondary network. See the
discussion in \fBgnt-cluster\fR(8) for more
informations.
.PP
In case you're readding a node after hardware failure, you
can use the \fB--readd\fR parameter.
.PP
Example:

.nf
# gnt-node add node5.example.com
# gnt-node add -s 192.168.44.5 node5.example.com
        
.fi
.SS "ADD-TAGS"

\fBadd-tags\fR [ \fB--from \fIfile\fB\fR ] \fB\fInodename\fB\fR \fB\fItag\fB\fR\fI ...\fR

.PP
Add tags to the given node. If any of the tags contains
invalid characters, the entire operation will abort.
.PP
If the \fB--from\fR option is given, the list of
tags will be extended with the contents of that file (each
line becomes a tag). In this case, there is not need to pass
tags on the command line (if you do, both sources will be
used). A file name of - will be interpreted as stdin.
.SS "EVACUATE"

\fBevacuate\fR [ \fB-f\fR ] \fB\fIsource_node\fB\fR \fB\fIdestination_node\fB\fR

.PP
This command will change the secondary node from the source
node to the destination node for all instances having the
source node as secondary. It works only for instances having
a remote_raid1 or drbd disk layout.
.PP
Example:

.nf
          # gnt-node evacuate node1.example.com node2.example.com
        
.fi
.SS "FAILOVER"

\fBfailover\fR [ \fB-f\fR ] [ \fB--ignore-consistency\fR ] \fB\fInode\fB\fR

.PP
This command will fail over all instances having the given
node as primary to their secondary nodes. This works only for
instances having a remote_raid1 or drbd disk layout.
.PP
Normally the failover will check the consistency of the disks
before failing over the instance. If you are trying to migrate
instances off a dead node, this will fail. Use the
\fB--ignore-consistency\fR option for this purpose.
.PP
Example:

.nf
          # gnt-node failover node1.example.com
        
.fi
.SS "INFO"

\fBinfo\fR [ \fB\fInode\fB\fR\fI ...\fR ]

.PP
Show detailed information about the nodes in the cluster. If you
don't give any arguments, all nodes will be shows, otherwise the
output will be restricted to the given names.
.SS "LIST"

\fBlist\fR [ \fB--no-headers\fR ] [ \fB--separator=\fISEPARATOR\fB\fR ] [ \fB-o \fI[+]FIELD,...\fB\fR ]

.PP
Lists the nodes in the cluster. If you give the
\fB--ip-info\fR option, the output contains just
the node name, primary ip and secondary ip. In case the
secondary ip is the same as the primary one, it will be listed
as \fB"-"\fR\&.
.PP
The \fB--no-headers\fR option will skip the initial
header line. The \fB--separator\fR option takes an
argument which denotes what will be used between the output
fields. Both these options are to help scripting.
.PP
The \fB-o\fR option takes a comma-separated list of
output fields. The available fields and their meaning are:
.TP
\fBname\fR
the node name
.TP
\fBpinst_cnt\fR
the number of instances having this node as
primary
.TP
\fBpinst_list\fR
the list of instances having this node as
primary, comma separated
.TP
\fBsinst_cnt\fR
the number of instances having this node as a
secondary node
.TP
\fBsinst_list\fR
the list of instances having this node as a
secondary node, comma separated
.TP
\fBpip\fR
the primary ip of this node (used for cluster
communication)
.TP
\fBsip\fR
the secondary ip of this node (used for data
replication in dual-ip clusters, see \fBgnt-cluster\fR(8)
.TP
\fBdtotal\fR
total disk space in the volume group used for
instance disk allocations
.TP
\fBdfree\fR
available disk space in the volume group
.TP
\fBmtotal\fR
total memory on the physical node
.TP
\fBmnode\fR
the memory used by the node itself
.TP
\fBmfree\fR
memory available for instance
allocations
.TP
\fBbootid\fR
the node bootid value; this is a linux specific
feature that assigns a new UUID to the node at each boot
and can be use to detect node reboots (by tracking
changes in this value)
.PP
If the value of the option starts with the character
+, the new fields will be added to the
default list. This allows to quickly see the default list plus
a few other fields, instead of retyping the entire list of
fields.
.PP
Note that some of this fields are known from the configuration
of the cluster (name, pinst, sinst, pip, sip and thus the master does
not need to contact the node for this data (making the listing
fast if only fields from this set are selected), whereas the
other fields are "live" fields and we need to make a query to
the cluster nodes.
.PP
Depending on the virtualization type and implementation
details, the mtotal, mnode and mfree may have slighly varying
meanings. For example, some solutions share the node memory
with the pool of memory used for instances
(UML), whereas others have separate memory
for the node and for the instances (Xen).
.SS "LIST-TAGS"

\fBlist-tags\fR \fB\fInodename\fB\fR

.PP
List the tags of the given node.
.SS "REMOVE"

\fBremove\fR \fB\fInodename\fB\fR

.PP
Removes a node from the cluster. Instances must be removed or
migrated to another cluster before.
.PP
Example:

.nf
# gnt-node remove node5.example.com
        
.fi
.SS "REMOVE-TAGS"

\fBremove-tags\fR [ \fB--from \fIfile\fB\fR ] \fB\fInodename\fB\fR \fB\fItag\fB\fR\fI ...\fR

.PP
Remove tags from the given node. If any of the tags are not
existing on the node, the entire operation will abort.
.PP
If the \fB--from\fR option is given, the list of
tags will be extended with the contents of that file (each
line becomes a tag). In this case, there is not need to pass
tags on the command line (if you do, both sources will be
used). A file name of - will be interpreted as stdin.
.SS "VOLUMES"

\fBvolumes\fR [ \fB--no-headers\fR ] [ \fB--human-readable\fR ] [ \fB--separator=\fISEPARATOR\fB\fR ] [ \fB--output=\fIFIELDS\fB\fR ]
    [ \fB\fInode\fB\fR\fI ...\fR ]

.PP
Lists all logical volumes and their physical disks from the node(s)
provided.
.PP
The \fB--no-headers\fR option will skip the initial
header line. The \fB--separator\fR option takes an
argument which denotes what will be used between the output
fields. Both these options are to help scripting.
.PP
The \fB-o\fR option takes a comma-separated list of
output fields. The available fields and their meaning are:
.TP
\fBnode\fR
the node name on which the volume exists
.TP
\fBphys\fR
the physical drive (on which the LVM physical
volume lives)
.TP
\fBvg\fR
the volume group name
.TP
\fBname\fR
the logical volume name
.TP
\fBsize\fR
the logical volume size
.TP
\fBinstance\fR
The name of the instance to which this volume
belongs, or (in case it's an orphan volume) the
character ``-''
.PP
Example:

.nf
# gnt-node volumes node5.example.com
Node              PhysDev   VG    Name                                 Size Instance
node1.example.com /dev/hdc1 xenvg instance1.example.com-sda_11000.meta 128  instance1.example.com
node1.example.com /dev/hdc1 xenvg instance1.example.com-sda_11001.data 256  instance1.example.com
        
.fi
.SH "REPORTING BUGS"
.PP
Report bugs to http://code.google.com/p/ganeti/ or contact the
developers using the ganeti mailing list
<ganeti@googlegroups.com>\&.
.SH "SEE ALSO"
.PP
Ganeti overview and specifications:
\fBganeti\fR(7) (general overview),
\fBganeti-os-interface\fR(7) (guest OS definitions).
.PP
Ganeti commands:
\fBgnt-cluster\fR(8) (cluster-wide commands),
\fBgnt-node\fR(8) (node-related commands),
\fBgnt-instance\fR(8) (instance commands),
\fBgnt-os\fR(8) (guest OS commands).
\fBgnt-backup\fR(8) (instance import/export commands).
.PP
Ganeti daemons:
\fBganeti-watcher\fR(8) (automatic instance restarter),
\fBganeti-noded\fR(8) (node daemon),
\fBganeti-master\fR(8) (the master startup script),
\fBganeti-rapi\fR(8) (remote API daemon).
.SH "COPYRIGHT"
.PP
Copyright (C) 2006, 2007 Google Inc. Permission is granted to
copy, distribute and/or modify under the terms of the GNU
General Public License as published by the Free Software
Foundation; either version 2 of the License, or (at your option)
any later version.
.PP
On Debian systems, the complete text of the GNU General Public
License can be found in /usr/share/common-licenses/GPL.
