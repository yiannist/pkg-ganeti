.\" This manpage has been automatically generated by docbook2man 
.\" from a DocBook document.  This tool can be found at:
.\" <http://shell.ipoline.com/~elmert/comp/docbook2X/> 
.\" Please send any bug reports, improvements, comments, patches, 
.\" etc. to Steve Cheng <steve@ggi-project.org>.
.TH "GANETI-OS-INTERFACE" "7" "10 January 2009" "ganeti 1.2" ""

.SH NAME
ganeti-os-interface \- specifications for guest OS types
.SH "DESCRIPTION"
.PP
The method of supporting guest operating systems in Ganeti is to
have, for each guest OS type, a directory containing a number of
required files.
.SH "REFERENCE"
.PP
There are five required files: \fIcreate\fR,
\fIimport\fR, \fIexport\fR,
\fIrename\fR (executables) and
\fIganeti_api_version\fR (text file).
.SS "CREATE"

\fBcreate\fR \fB-i \fIinstance_name\fB\fR \fB-b \fIblockdev_sda\fB\fR \fB-s \fIblockdev_sdb\fB\fR

.PP
The \fBcreate\fR command is used for creating
a new instance from scratch.
.PP
The argument to the \fB-i\fR option is the FQDN
of the instance, which is guaranteed to resolve to an IP
address. The create script should configure the instance
according to this name. It can configure the IP statically or
not, depending on the deployment environment.
.PP
The \fB-b\fR and \fB-s\fR options
denote the block devices which will be visible in the instance
as \fBsda\fR and \fBsdb\fR\&. The
\fBsda\fR block device should be used for the
root disk (and will be passed as the root device for Linux
kernels). The \fBsdb\fR device should be setup
for swap usage.
.SS "IMPORT"

\fBimport\fR \fB-i \fIinstance_name\fB\fR \fB-b \fIblockdev_sda\fB\fR \fB-s \fIblockdev_sdb\fB\fR

.PP
The \fBimport\fR command is used for restoring an
instance from a backup as done by
\fBexport\fR\&. The arguments are the same as for
\fBcreate\fR and the output of the
\fBexport\fR will be provided on
stdin\&.
.SS "EXPORT"

\fBexport\fR \fB-i \fIinstance_name\fB\fR \fB-b \fIblockdev_sda\fB\fR

.PP
This command is used in order to make a backup of the
instance. The command should write to stdout a dump of the
given block device. The output of this program will be passed
to the \fBimport\fR command.
.PP
The options have the same meaning as for
\fBcreate\fR and \fBimport\fR, with
the exception that the argument to \fB-i\fR denotes
an existing instance.
.SS "RENAME"

\fBrename\fR \fB-o \fIold_name\fB\fR \fB-n \fInew_name\fB\fR \fB-b \fIblockdev_sda\fB\fR \fB-s \fIblockdev_sdb\fB\fR

.PP
This command is used in order to perform a rename at the
instance OS level, after the instance has been renamed in
Ganeti. The command should do whatever steps are required to
ensure that the instance is updated to use the new name, if
the operating system supports it.
.PP
Note that it is acceptable for the rename script to do nothing
at all, however be warned that in this case, there will be a
desynchronization between what gnt-instance
list shows you and the actual hostname of the
instance.
.PP
A very simple rename script should at least change the
hostname and IP address of the instance, leaving the
administrator to update the other services.
.SS "GANETI_API_VERSION"
.PP
The \fIganeti_api_version\fR file is a plain
text file containing the version of the guest OS api that this
OS definition complies with. The version documented by this
man page is 5, so this file must contain the number 5 followed
by a newline.
.SH "NOTES"
.SS "COMMON BEHAVIOUR"
.PP
All the scripts should display an usage message when called with a wrong number of arguments or when the first argument is \fB-h\fR or \fB--help\fR\&.
.SS "UPGRADING FROM OLD VERSIONS"
.SS "VERSION 4 TO 5"
.PP
The \fIrename\fR script has been added. If
you don't want to do any changes on the instances after a
rename, you can migrate the OS definition to version 5 by
creating the \fIrename\fR script simply as:

.nf
#!/bin/sh

exit 0
          
.fi
.PP
Note that the script must be executable.
.SH "REPORTING BUGS"
.PP
Report bugs to http://code.google.com/p/ganeti/ or contact the
developers using the ganeti mailing list
<ganeti@googlegroups.com>\&.
.SH "SEE ALSO"
.PP
Ganeti overview and specifications:
\fBganeti\fR(7) (general overview),
\fBganeti-os-interface\fR(7) (guest OS definitions).
.PP
Ganeti commands:
\fBgnt-cluster\fR(8) (cluster-wide commands),
\fBgnt-node\fR(8) (node-related commands),
\fBgnt-instance\fR(8) (instance commands),
\fBgnt-os\fR(8) (guest OS commands).
\fBgnt-backup\fR(8) (instance import/export commands).
.PP
Ganeti daemons:
\fBganeti-watcher\fR(8) (automatic instance restarter),
\fBganeti-noded\fR(8) (node daemon),
\fBganeti-master\fR(8) (the master startup script),
\fBganeti-rapi\fR(8) (remote API daemon).
.SH "COPYRIGHT"
.PP
Copyright (C) 2006, 2007, 2008 Google Inc. Permission is granted
to copy, distribute and/or modify under the terms of the GNU
General Public License as published by the Free Software
Foundation; either version 2 of the License, or (at your option)
any later version.
.PP
On Debian systems, the complete text of the GNU General Public
License can be found in /usr/share/common-licenses/GPL.
