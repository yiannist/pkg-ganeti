.\" This manpage has been automatically generated by docbook2man 
.\" from a DocBook document.  This tool can be found at:
.\" <http://shell.ipoline.com/~elmert/comp/docbook2X/> 
.\" Please send any bug reports, improvements, comments, patches, 
.\" etc. to Steve Cheng <steve@ggi-project.org>.
.TH "GANETI-MASTERD" "8" "01 July 2010" "ganeti 2.0" ""

.SH NAME
ganeti-masterd \- ganeti master daemon
.SH SYNOPSIS

\fBganeti-masterd \fR [ \fB-f\fR ] [ \fB-d\fR ] [ \fB--no-voting\fR ]

.SH "DESCRIPTION"
.PP
The \fBganeti-masterd\fR is the daemon which is
responsible for the overall cluster coordination. Without it, no
change can be performed on the cluster.
.PP
For testing purposes, you can give the \fB-f\fR
option and the program won't detach from the running terminal.
.PP
Debug-level message can be activated by giving the
\fB-d\fR option.
.SS "ROLE"
.PP
The role of the master daemon is to coordinate all the actions
that change the state of the cluster. Things like accepting
new jobs, coordinating the changes on nodes (via RPC calls to
the respective node daemons), maintaining the configuration
and so on are done via this daemon.
.PP
The only action that can be done without the master daemon is
the failover of the master role to another node in the
cluster, via the \fBgnt-cluster masterfailover\fR
command.
.PP
If the master daemon is stopped, the instances are not
affected, but they won't be restarted automatically in case of
failure.
.SS "STARTUP"
.PP
At startup, the master daemon will confirm with the node
daemons that the node it is running is indeed the master node
of the cluster. It will abort if it doesn't get half plus one
positive answers (offline nodes are queried too, just in case
our configuration is stale).
.PP
For small clusters with a number of nodes down, and especially
for two-node clusters where the other has gone done, this
creates a problem. In this case the
\fB--no-voting\fR option can be used to skip this
process. The option requires interactive confirmation, as
having two masters on the same cluster is a very dangerous
situation and will most likely lead to data loss.
.SS "JOB QUEUE"
.PP
The master daemon maintains a job queue (located under
\fI@LOCALSTATEDIR@/lib/ganeti/queue\fR) in
which all current jobs are stored, one job per file serialized
in JSON format; in this directory a subdirectory called
\fIarchive\fR holds archived
job files.
.PP
The moving of jobs from the current to the queue directory is
done via a request to the master; this can be accomplished
from the command line with the \fBgnt-job
archive\fR or \fBgnt-job autoarchive\fR
commands. In case of problems with the master, a job file can
simply be moved away or deleted (but this might leave the
cluster inconsistent).
.SS "COMMUNICATION PROTOCOL"
.PP
The master accepts commands over a Unix socket, using JSON
serialized messages separated by a specific byte sequence. For
more details, see the design documentation supplied with
Ganeti.
.SH "REPORTING BUGS"
.PP
Report bugs to  <URL:http://code.google.com/p/ganeti/> or contact the
developers using the ganeti mailing list
<ganeti@googlegroups.com>\&.
.SH "SEE ALSO"
.PP
Ganeti overview and specifications:
\fBganeti\fR(7) (general overview),
\fBganeti-os-interface\fR(7) (guest OS definitions).
.PP
Ganeti commands:
\fBgnt-cluster\fR(8) (cluster-wide commands),
\fBgnt-job\fR(8) (job-related commands),
\fBgnt-node\fR(8) (node-related commands),
\fBgnt-instance\fR(8) (instance commands),
\fBgnt-os\fR(8) (guest OS commands),
\fBgnt-backup\fR(8) (instance import/export commands),
\fBgnt-debug\fR(8) (debug commands).
.PP
Ganeti daemons:
\fBganeti-watcher\fR(8) (automatic instance restarter),
\fBganeti-cleaner\fR(8) (job queue cleaner),
\fBganeti-noded\fR(8) (node daemon),
\fBganeti-masterd\fR(8) (master daemon),
\fBganeti-rapi\fR(8) (remote API daemon).
.SH "COPYRIGHT"
.PP
Copyright (C) 2006, 2007, 2008, 2009 Google Inc. Permission is
granted to copy, distribute and/or modify under the terms of the
GNU General Public License as published by the Free Software
Foundation; either version 2 of the License, or (at your option)
any later version.
.PP
On Debian systems, the complete text of the GNU General Public
License can be found in /usr/share/common-licenses/GPL.
