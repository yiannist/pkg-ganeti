.\" This manpage has been automatically generated by docbook2man 
.\" from a DocBook document.  This tool can be found at:
.\" <http://shell.ipoline.com/~elmert/comp/docbook2X/> 
.\" Please send any bug reports, improvements, comments, patches, 
.\" etc. to Steve Cheng <steve@ggi-project.org>.
.TH "GNT-DEBUG" "8" "19 October 2010" "Ganeti 2.2" ""

.SH NAME
gnt-debug \- Debug commands
.SH SYNOPSIS

\fBgnt-debug \fR \fBcommand\fR [ \fBarguments...\fR ]

.SH "DESCRIPTION"
.PP
The \fBgnt-debug\fR is used for debugging the
Ganeti system.
.SH "COMMANDS"
.SS "ALLOCATOR"

\fBallocator\fR [ \fB--debug\fR ] [ \fB--dir \fIDIRECTION\fB\fR ] \fB--algorithm \fIALLOCATOR\fB
\fR [ \fB--mode \fIMODE\fB\fR ] [ \fB--mem \fIMEMORY\fB\fR ] [ \fB--disks \fIDISKS\fB\fR ] [ \fB--disk-template \fITEMPLATE\fB\fR ] [ \fB--nics \fINICS\fB\fR ] [ \fB--os-type \fIOS\fB\fR ] [ \fB--vcpus \fIVCPUS\fB\fR ] [ \fB--tags \fITAGS\fB\fR ] \fB\fIinstance\fB\fR

.PP
Executes a test run of the \fBiallocator\fR framework.
.PP
The command will build input for a given iallocator script
(named with the \fB--algorithm\fR option), and
either show this input data (if
\fIDIRECTION\fR is
\fBin\fR) or run the iallocator script and show
its output (if \fIDIRECTION\fR is
\fBout\fR).
.PP
If the \fIMODE\fR is
\fBallocate\fR, then an instance definition is
built from the other arguments and sent to the script,
otherwise (\fIMODE\fR is
\fBrelocate\fR) an existing instance name must
be passed as the first argument.
.PP
This build of Ganeti will look for iallocator scripts in the
following directories: \fI@CUSTOM_IALLOCATOR_SEARCH_PATH@\fR;
for more details about this framework, see the HTML or PDF
documentation.
.SS "DELAY"

\fBdelay\fR [ \fB--debug\fR ] [ \fB--no-master\fR ] [ \fB-n \fINODE\fB\fR\fI ...\fR ] \fB\fIduration\fB\fR

.PP
Run a test opcode (a sleep) on the master and on selected nodes
(via an RPC call). This serves no other purpose but to execute a
test operation.
.PP
The \fB-n\fR option can be given multiple times to
select the nodes for the RPC call. By default, the delay will
also be executed on the master, unless the
\fB--no-master\fR option is passed.
.PP
The \fIdelay\fR argument will be
interpreted as a floating point number.
.SS "SUBMIT-JOB"

\fBsubmit-job\fR [ \fB--verbose\fR ] [ \fB--timing-stats\fR ] [ \fB--job-repeat N\fR ] [ \fB--op-repeat N\fR ] \fBopcodes_file\fR\fI ...\fR

.PP
This command builds a list of opcodes from files in JSON format
and submits a job per file to the master daemon. It can be used
to test options that are not available via command line.
.PP
The \fBverbose\fR option will additionally display
the corresponding job IDs and the progress in waiting for the
jobs; the \fBtiming-stats\fR option will show some
overall statistics inluding the number of total opcodes, jobs
submitted and time spent in each stage (submit, exec, total).
.PP
The \fBjob-repeat\fR and \fBop-repeat\fR
options allow to submit multiple copies of the passed arguments;
job-repeat will cause N copies of each job (input file) to be
submitted (equivalent to passing the arguments N times) while
op-repeat will cause N copies of each of the opcodes in the file
to be executed (equivalent to each file containing N copies of
the opcodes).
.SS "TEST-JOBQUEUE"

\fBtest-jobqueue\fR

.PP
Executes a few tests on the job queue. This command might generate
failed jobs deliberately.
.SS "LOCKS"

\fBlocks\fR [ \fB--no-headers\fR ] [ \fB--separator=\fISEPARATOR\fB\fR ]
    [ \fB-o \fI[+]FIELD,...\fB\fR ] [ \fB--interval=\fISECONDS\fB\fR ]
   

.PP
Shows a list of locks in the master daemon.
.PP
The \fB--no-headers\fR option will skip the initial
header line. The \fB--separator\fR option takes an
argument which denotes what will be used between the output
fields. Both these options are to help scripting.
.PP
The \fB-o\fR option takes a comma-separated list of
output fields. The available fields and their meaning are:
.TP
\fBname\fR
Lock name
.TP
\fBmode\fR
Mode in which the lock is currently acquired (exclusive or
shared)
.TP
\fBowner\fR
Current lock owner(s)
.TP
\fBpending\fR
Threads waiting for the lock
.PP
If the value of the option starts with the character
+, the new fields will be added to the default
list. This allows to quickly see the default list plus a few other
fields, instead of retyping the entire list of fields.
.PP
Use \fB--interval\fR to repeat the listing. A delay
specified by the option value in seconds is inserted.
.SH "REPORTING BUGS"
.PP
Report bugs to  <URL:http://code.google.com/p/ganeti/> or contact the
developers using the Ganeti mailing list
<ganeti@googlegroups.com>\&.
.SH "SEE ALSO"
.PP
Ganeti overview and specifications:
\fBganeti\fR(7) (general overview),
\fBganeti-os-interface\fR(7) (guest OS definitions).
.PP
Ganeti commands:
\fBgnt-cluster\fR(8) (cluster-wide commands),
\fBgnt-job\fR(8) (job-related commands),
\fBgnt-node\fR(8) (node-related commands),
\fBgnt-instance\fR(8) (instance commands),
\fBgnt-os\fR(8) (guest OS commands),
\fBgnt-backup\fR(8) (instance import/export commands),
\fBgnt-debug\fR(8) (debug commands).
.PP
Ganeti daemons:
\fBganeti-watcher\fR(8) (automatic instance restarter),
\fBganeti-cleaner\fR(8) (job queue cleaner),
\fBganeti-noded\fR(8) (node daemon),
\fBganeti-masterd\fR(8) (master daemon),
\fBganeti-rapi\fR(8) (remote API daemon).
.SH "COPYRIGHT"
.PP
Copyright (C) 2006, 2007, 2008, 2009, 2010 Google Inc. Permission is
granted to copy, distribute and/or modify under the terms of the
GNU General Public License as published by the Free Software
Foundation; either version 2 of the License, or (at your option)
any later version.
.PP
On Debian systems, the complete text of the GNU General Public
License can be found in /usr/share/common-licenses/GPL.
